var ready=!1,complete=!1,prevOrNext="next",i,debug=!0,autoplayFirstVideo=!0,autoplayPlyr=!0,controlsPlyr=["mute","volume","play-large","play","progress","settings","pip","airplay","fullscreen"],controlsPlyr_old=["<div class='plyr__controls'>","<button type='button' class='plyr__control playPrevious' data-plyr='forward' aria-label='",i18n_videohandler_previoussnippet,"'>","<span class='fas fa-backward'></span>","<span class='label plyr__tooltip' role='tooltip'>",i18n_videohandler_previoussnippet,"</span>","</button>",'<button type="button" class="plyr__control" aria-pressed="false" aria-label="',i18n_videohandler_play,'" data-plyr="play"><svg class="icon--pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-pause"></use></svg><svg class="icon--not-pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-play"></use></svg><span class="label--pressed plyr__tooltip" role="tooltip">',i18n_videohandler_pause,'</span><span class="label--not-pressed plyr__tooltip" role="tooltip">',i18n_videohandler_play,"</span></button>","<button type='button' class='plyr__control playNext' data-plyr='forward' aria-label='",i18n_videohandler_nextsnippet,"'>","<span class='fas fa-forward'></span>","<span class='label plyr__tooltip' role='tooltip'>",i18n_videohandler_nextsnippet,"</span>","</button>",'<button type="button" class="plyr__control" aria-pressed="false" aria-label="',i18n_videohandler_togglemute,'" data-plyr="mute"><svg class="icon--pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-muted"></use></svg><svg class="icon--not-pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-volume"></use></svg><span class="label--pressed plyr__tooltip" role="tooltip">',i18n_videohandler_togglemute,'</span><span class="label--not-pressed plyr__tooltip" role="tooltip">',i18n_videohandler_togglemute,'</span></button><div class="plyr__volume"><input data-plyr="volume" type="range" min="0" max="1" step="0.05" value="1" autocomplete="off" aria-label="',i18n_videohandler_volume,'"></div>','<div class="plyr__progress"><input data-plyr="seek" type="range" min="0" max="100" step="0.01" value="0" aria-label="',i18n_videohandler_seek,'"><progress class="plyr__progress__buffer" min="0" max="100" value="0">% ',i18n_videohandler_seek,'</progress><span role="tooltip" class="plyr__tooltip">00:00</span></div>','<!--<button type="button" class="plyr__control" aria-pressed="false" aria-label="Enable captions" data-plyr="captions"><svg class="icon--pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-captions-on"></use></svg><svg class="icon--not-pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-captions-off"></use></svg><span class="label--pressed plyr__tooltip" role="tooltip">Disable captions</span><span class="label--not-pressed plyr__tooltip" role="tooltip">Enable captions</span></button><div class="plyr__menu"><button id="plyr-settings-toggle-{id}" aria-haspopup="true" aria-controls="plyr-settings-{id}" aria-expanded="false" type="button" class="plyr__control" data-plyr="settings"><svg role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-settings"></use></svg><span class="plyr__tooltip" role="tooltip">Settings</span></button><form class="plyr__menu__container" id="plyr-settings-{id}" aria-hidden="true" aria-labelled-by="plyr-settings-toggle-{id}" role="tablist" tabindex="-1"><div><div id="plyr-settings-{id}-home" aria-hidden="false" aria-labelled-by="plyr-settings-toggle-{id}" role="tabpanel"><ul role="tablist"><li role="tab" hidden=""><button data-plyr="settings" type="button" class="plyr__control plyr__control--forward" id="plyr-settings-{id}-captions-tab" aria-haspopup="true" aria-controls="plyr-settings-{id}-captions" aria-expanded="false">Captions<span class="plyr__menu__value">None</span></button></li><li role="tab"><button data-plyr="settings" type="button" class="plyr__control plyr__control--forward" id="plyr-settings-{id}-quality-tab" aria-haspopup="true" aria-controls="plyr-settings-{id}-quality" aria-expanded="false">Quality<span class="plyr__menu__value">480P</span></button></li><li role="tab"><button data-plyr="settings" type="button" class="plyr__control plyr__control--forward" id="plyr-settings-{id}-speed-tab" aria-haspopup="true" aria-controls="plyr-settings-{id}-speed" aria-expanded="false">Speed<span class="plyr__menu__value">Normal</span></button></li></ul></div><div id="plyr-settings-{id}-captions" aria-hidden="true" aria-labelled-by="plyr-settings-{id}-captions-tab" role="tabpanel" tabindex="-1" hidden=""><button type="button" class="plyr__control plyr__control--back" aria-haspopup="true" aria-controls="plyr-settings-{id}-home" aria-expanded="false">Captions</button><ul></ul></div><div id="plyr-settings-{id}-quality" aria-hidden="true" aria-labelled-by="plyr-settings-{id}-quality-tab" role="tabpanel" tabindex="-1"><button type="button" class="plyr__control plyr__control--back" aria-haspopup="true" aria-controls="plyr-settings-{id}-home" aria-expanded="false">Quality</button><ul><li><label class="plyr__control"><input data-plyr="quality" name="plyr-quality" value="hd1080" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>1080P<span class="plyr__menu__value"><span class="plyr__badge">HD</span></span></label></li><li><label class="plyr__control"><input data-plyr="quality" name="plyr-quality" value="hd720" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>720P<span class="plyr__menu__value"><span class="plyr__badge">HD</span></span></label></li><li><label class="plyr__control"><input data-plyr="quality" name="plyr-quality" value="large" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>480P</label></li><li><label class="plyr__control"><input data-plyr="quality" name="plyr-quality" value="medium" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>360P</label></li><li><label class="plyr__control"><input data-plyr="quality" name="plyr-quality" value="small" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>240P</label></li><li><label class="plyr__control"><input data-plyr="quality" name="plyr-quality" value="tiny" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>Tiny</label></li></ul></div><div id="plyr-settings-{id}-speed" aria-hidden="true" aria-labelled-by="plyr-settings-{id}-speed-tab" role="tabpanel" tabindex="-1"><button type="button" class="plyr__control plyr__control--back" aria-haspopup="true" aria-controls="plyr-settings-{id}-home" aria-expanded="false">Speed</button><ul><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="0.5" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>0.5×</label></li><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="0.75" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>0.75×</label></li><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="1" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>Normal</label></li><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="1.25" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>1.25×</label></li><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="1.5" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>1.5×</label></li><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="1.75" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>1.75×</label></li><li><label class="plyr__control"><input data-plyr="speed" name="plyr-speed" value="2" checked="false" class="plyr__sr-only" type="radio"><span aria-hidden="true"></span>2×</label></li></ul></div></div></form></div>-->',"<button type='button' class='playComplete plyr__control' data-plyr='forward' aria-label='",i18n_videohandler_completesnippet,"'>","<span class='fas fa-plus-square'></span>","<span class='label plyr__tooltip' role='tooltip'>",i18n_videohandler_completesnippet,"</span>","</button>","<button type='button' class='plyr__control playMix' data-plyr='forward' aria-label='",i18n_videohandler_mix,"'>","<span class='fas fa-random'></span>","<span class='label plyr__tooltip' role='tooltip'>",i18n_videohandler_mix,"</span>","</button>","<button type='button' class='plyr__control searchLyrics' data-plyr='forward' aria-label='",i18n_videohandler_lyrics,"'>","<span class='fas fa-file-alt'></span>","<span class='label plyr__tooltip' role='tooltip'>",i18n_videohandler_lyrics,"</span>","</button>",'<button type="button" class="plyr__control" aria-pressed="false" aria-label="',i18n_videohandler_togglefullscreen,'" data-plyr="fullscreen"><svg class="icon--pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-exit-fullscreen"></use></svg><svg class="icon--not-pressed" role="presentation"><use xlink:href="/static/img/plyr/plyr.svg#plyr-enter-fullscreen"></use></svg><span class="label--pressed plyr__tooltip" role="tooltip">',i18n_videohandler_togglefullscreen,'</span><span class="label--not-pressed plyr__tooltip" role="tooltip">',i18n_videohandler_togglefullscreen,"</span></button>","</div>"].join(""),optionsPlyr={autoplay:autoplayPlyr,blankUrl:"/static/blank.mp4",debug:!1,iconUrl:"/static/img/plyr/plyr-3.3.7.svg",keyboard:{global:!1,focused:!1},tooltips:{controls:!0},captions:{active:!1},controls:controlsPlyr},video=new Plyr(".plyr",optionsPlyr);video[0]=video;var elementMessage=document.getElementsByClassName("message")[0],elementPlayPause=document.getElementsByClassName("playPause")[0],snippets=document.getElementById("snippets").getElementsByTagName("a"),debugMessage=function(e,a){debug&&("undefined"==typeof a&&(a=!1),a?console.warn(e):console.log(e))},toggleMessage=function(){elementMessage.style.visibility="hidden",elementMessage.style.opacity="0"},showMessage=function(e,a){"undefined"==typeof a&&(a=10),elementMessage.innerHTML='<i class="fas fa-exclamation-triangle"></i> '+e,elementMessage.style.visibility="visible",elementMessage.style.opacity="1",a>0&&setInterval(toggleMessage,1e3*a)},playPause=function(){video[0].togglePlay();var e=video[0].paused;if(newElement=document.createElement("i"),e){for(;elementPlayPause.firstChild;)elementPlayPause.removeChild(elementPlayPause.firstChild);newElement.classList="fas fa-play",elementPlayPause.appendChild(newElement)}else{for(;elementPlayPause.firstChild;)elementPlayPause.removeChild(elementPlayPause.firstChild);newElement.classList="fas fa-pause",elementPlayPause.appendChild(newElement)}},playComplete=function(){video[0].pause(),video[0].currentTime=0,complete=!0,video[0].play()},playPrevious=function(){i>0&&(prevOrNext="prev",i--,jumpTo(i),updateElements())},playNext=function(){i<snippets.length-1&&(prevOrNext="next",i++,jumpTo(i),updateElements())},playMix=function(){window.open(document.getElementsByClassName("playMix")[1].href,"_self")},searchLyrics=function(){window.open(document.getElementsByClassName("searchLyrics")[1].href,"blank")},updateElements=function(){var e,a=document.getElementsByClassName("countdown");a.length>1&&a[1].classList.toggle("countdown");var l=snippets[i].getElementsByClassName("name")[0].innerText,s=document.createElement("div");s.classList.add("countdown"),snippets[i].insertBefore(s,snippets[i].getElementsByTagName("p")[0]),document.getElementById("title").innerHTML=l,document.getElementsByTagName("title")[0].innerHTML=l+" - "+document.getElementById("snippets").dataset.playlisttitle+" - newsic",e=0,document.getElementsByClassName("searchLyrics")[e].href="https://genius.com/search?q="+l.replace(/\s+/g,"+"),document.getElementsByClassName("playMix")[e].href="/"+snippets[i].dataset.type+"/mix/"+snippets[i].dataset.id},jumpTo=function(e){video[0].source={type:"video",sources:[{src:snippets[e].dataset.id,provider:snippets[e].dataset.type}]}},mindTheHash=function(){if(location.hash){debugMessage("Hash is set");var e=window.location.hash.replace("#","");i=e<snippets.length?e:window.location.hash=snippets.length-1}else i=0;debugMessage("This is the beginning of a newsic session, the player is ready. Whoop whoop, fasten your seatbelts, etc."),jumpTo(i),updateElements()};video[0].on("ready",function(){video[0].pause(),complete=!1,playPreviousElements=document.getElementsByClassName("playPrevious"),playNextElements=document.getElementsByClassName("playNext"),playCompleteElements=document.getElementsByClassName("playComplete"),playMixElements=document.getElementsByClassName("playMix"),searchLyricsElements=document.getElementsByClassName("searchLyrics"),"vimeo"===snippets[i].dataset.type&&(ready=!0),"youtube"===snippets[i].dataset.type&&(video.currentTime=parseFloat(snippets[i].getAttribute("data-start"))),debugMessage("Jumped to start time."),debugMessage(snippets[i].dataset.id+" "+snippets[i].dataset.start+" "+snippets[i].dataset.end),autoplayFirstVideo||location.hash||0!==i||"prev"==prevOrNext?video[0].play():video[0].pause()}),video[0].on("playing",function(){for(;elementPlayPause.firstChild;)elementPlayPause.removeChild(elementPlayPause.firstChild);newElement=document.createElement("i"),newElement.classList="fas fa-pause",elementPlayPause.appendChild(newElement),"vimeo"===snippets[i].dataset.type&&ready&&(console.log("playing event"),video.currentTime=parseFloat(snippets[i].getAttribute("data-start")),debugMessage("Jumped to start time."),debugMessage(snippets[i].dataset.id+" "+snippets[i].dataset.start+" "+snippets[i].dataset.end),ready=!1)}),video[0].on("pause",function(){for(;elementPlayPause.firstChild;)elementPlayPause.removeChild(elementPlayPause.firstChild);newElement=document.createElement("i"),newElement.classList="fas fa-play",elementPlayPause.appendChild(newElement)}),video[0].on("error",function(e){var a=snippets[i].getElementsByClassName("name")[0].innerText;"youtube"==snippets[i].dataset.type&&(debugMessage("Error: "+e.detail.code),showMessage(150==e.detail.code||101==e.detail.code?a+": "+i18n_videohandler_embeddingforbidden:a+": "+i18n_videohandler_blocked),"prev"==prevOrNext?playPrevious():playNext())}),video[0].on("timeupdate",function(){if(i<snippets.length){var e=parseFloat(snippets[i].dataset.end),a=parseFloat(snippets[i].dataset.start);complete&&(e=parseFloat(snippets[i].dataset.length),a=0);var l=document.getElementsByClassName("countdown"),s=video[0].currentTime,t=Math.floor(e-s)/(e-a)*100+"%";l[0].style.width=l[1].style.width=t,Math.ceil(s)>=e&&(i==snippets.length-1?(video[0].pause(),debugMessage("This party is over, now get out of here. Seriously.")):(debugMessage("End of snippet, let's go to the next one."),playNext()))}}),mindTheHash(),window.onhashchange=mindTheHash,document.addEventListener("keydown",function(e){if("input"!==e.target.nodeName.toLowerCase()&&!e.ctrlKey&&!e.altKey&&!e.shiftKey)switch(e.key){case"f":video[0].fullscreen.toggle();break;case"l":searchLyrics();break;case"m":video[0].muted?video[0].muted=!1:video[0].muted=!0;break;case"x":playMix();break;case"k":case"s":case" ":e.preventDefault(),playPause();break;case"c":playComplete();break;case"a":case"ArrowLeft":playPrevious();break;case"d":case"ArrowRight":playNext()}},!1);
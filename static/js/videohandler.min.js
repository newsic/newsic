var ready=!1,complete=!1,prevOrNext="next",i,debug=!0,autoplayFirstVideo=!0,autoplayPlyr=!0,controls=["<div class='plyr__controls'>","<button class='playPrevious' type='button' data-plyr='backward'>","<span class='fa fa-backward'></span>","<span class='plyr__sr-only'>Previous snippet</span>","</button>","<button type='button' data-plyr='play'>","<span class='fa fa-play'></span>","<span class='plyr__sr-only'>Play</span>","</button>","<button type='button' data-plyr='pause'>","<span class='fa fa-pause'></span>","<span class='plyr__sr-only'>Pause</span>","</button>","<button class='playNext' type='button' data-plyr='forward'>","<span class='fa fa-forward'></span>","<span class='plyr__sr-only'>Next snippet</span>","</button>","<button type='button' data-plyr='mute'>","<svg class='icon--muted'><use xlink:href='/static/img/plyr/plyr.svg#plyr-muted'></use></svg>","<svg><use xlink:href='/static/img/plyr/plyr.svg#plyr-volume'></use></svg>","<span class='plyr__sr-only'>Toggle mute</span>","</button>","<span class='plyr__volume'>","<label for='volume{id}' class='plyr__sr-only'>Volume</label>","<input id='volume{id}' class='plyr__volume--input' type='range' min='0' max='10' value='5' data-plyr='volume'>","<progress class='plyr__volume--display' max='10' value='0' role='presentation'></progress>","</span>","<span class='plyr__progress'>","<label for='seek{id}' class='plyr__sr-only'>Seek</label>","<input id='seek{id}' class='plyr__progress--seek' type='range' min='0' max='100' step='0.1' value='0' data-plyr='seek'>","<progress class='plyr__progress--played' max='100' value='0' role='presentation'></progress>","<progress class='plyr__progress--buffer' max='100' value='0'>","<span>0</span>% buffered","</progress>","<span class='plyr__tooltip'>00:00</span>","</span>","<button class='playComplete' type='button' data-plyr='complete'>","<span class='fa fa-plus-square'></span>","<span class='plyr__sr-only'>Complete snippet</span>","</button>","<button class='playMix' type='button' data-plyr='mix'>","<span class='fa fa-random'></span>","<span class='plyr__sr-only'>Mix</span>","</button>","<button class='searchLyrics' type='button' data-plyr='lyrics'>","<span class='fa fa-file-text-o'></span>","<span class='plyr__sr-only'>Lyrics</span>","</button>","<button type='button' data-plyr='fullscreen'>","<svg class='icon--exit-fullscreen'><use xlink:href='/static/img/plyr/plyr.svg#plyr-exit-fullscreen'></use></svg>","<svg><use xlink:href='/static/img/plyr/plyr.svg#plyr-enter-fullscreen'></use></svg>","<span class='plyr__sr-only'>Toggle fullscreen</span>","</button>","</div>"].join(""),options_plyr2={debug:!1,autoplay:autoplayPlyr,iconUrl:"/static/img/plyr/plyr.svg",blankUrl:"/static/blank.mp4",html:controls,tooltips:{controls:!0,seek:!0},keyboardShorcuts:{focused:!1,global:!1}},options_plyr3={autoplay:autoplayPlyr,blankUrl:"/static/blank.mp4",debug:!1,iconUrl:"/static/img/plyr/3/plyr.svg",keyboard:{global:!1,focused:!1},tooltips:{controls:!0},captions:{active:!1},controls:["play-large","play","progress","current-time","mute","volume","settings","fullscreen"]},video=plyr.setup(".plyr",options_plyr2),elementMessage=document.getElementsByClassName("message")[0],elementPlayPause=document.getElementsByClassName("playPause fa fa-play")[0],snippets=document.getElementById("snippets").children,debugMessage=function(e){debug&&console.log(e)},toggleMessage=function(){elementMessage.style.visibility="hidden",elementMessage.style.opacity="0"},showMessage=function(e,s){"undefined"==typeof s&&(s=10),elementMessage.innerHTML='<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> '+e,elementMessage.style.visibility="visible",elementMessage.style.opacity="1",s>0&&setInterval(toggleMessage,1e3*s)},playPause=function(){video[0].togglePlay(),video[0].isPaused()?elementPlayPause.className="playPause fa fa-play":elementPlayPause.className="playPause fa fa-pause"},playComplete=function(){video[0].seek(0),complete=!0},playPrevious=function(){i>0&&(prevOrNext="prev",i--,jumpTo(i),updateElements())},playNext=function(){i<snippets.length-1&&(prevOrNext="next",i++,jumpTo(i),updateElements())},playMix=function(){window.open(document.getElementsByClassName("playMix")[1].href,"_self")},searchLyrics=function(){window.open(document.getElementsByClassName("searchLyrics")[1].href,"blank")},updateElements=function(){var e=document.getElementsByClassName("countdown");e.length>1&&e[1].classList.toggle("countdown");var s=snippets[i].getElementsByClassName("name")[0].innerText,t=document.createElement("div");t.classList.add("countdown"),snippets[i].insertBefore(t,snippets[i].getElementsByTagName("p")[0]),document.getElementById("title").innerHTML=s,document.getElementsByTagName("title")[0].innerHTML=s+" - "+document.getElementById("snippets").dataset.playlisttitle+" - newsic",document.getElementsByClassName("searchLyrics")[1].href="https://genius.com/search?q="+s.replace(/\s+/g,"+"),"youtube"==snippets[i].dataset.type&&(document.getElementsByClassName("playMix")[1].href="/youtube/mix/"+snippets[i].dataset.id),"vimeo"==snippets[i].dataset.type&&(document.getElementsByClassName("playMix")[1].href="/vimeo/mix/"+snippets[i].dataset.id)},jumpTo=function(e){video[0].source({type:"video",sources:[{src:snippets[e].dataset.id,type:snippets[e].dataset.type}]})},mindTheHash=function(){if(location.hash){debugMessage("Hash is set");var e=window.location.hash.replace("#","");i=e<snippets.length?e:window.location.hash=snippets.length-1}else i=0;debugMessage("This is the beginning of a newsic session, the player is ready. Whoop whoop, fasten your seatbelts, etc."),jumpTo(i),updateElements()};video[0].on("ready",function(){complete=!1,autoplayFirstVideo||location.hash||0!==i||"prev"==prevOrNext?"vimeo"===snippets[i].dataset.type&&(ready=!0):video[0].pause(),"youtube"===snippets[i].dataset.type&&(video[0].seek(parseFloat(snippets[i].getAttribute("data-start"))),debugMessage("Jumped to start time."),debugMessage(snippets[i].dataset.id+" "+snippets[i].dataset.start+" "+snippets[i].dataset.end))}),video[0].on("playing",function(){elementPlayPause.className="playPause fa fa-pause","vimeo"===snippets[i].dataset.type&&ready&&(video[0].seek(parseFloat(snippets[i].dataset.start)),debugMessage("Jumped to start time."),debugMessage(snippets[i].dataset.id+" "+snippets[i].dataset.start+" "+snippets[i].dataset.end),ready=!1)}),video[0].on("error",function(e){var s=snippets[i].getElementsByClassName("name")[0].innerText;"youtube"==snippets[i].dataset.type?(debugMessage("Error: "+e.detail.code),showMessage(150==e.detail.code||101==e.detail.code?s+": Embedding forbidden or blocked in your country":"Sorry, but "+s+" isn't available in your country.")):showMessage("Video skipped."),"prev"==prevOrNext?playPrevious():playNext()}),video[0].on("pause",function(){elementPlayPause.className="playPause fa fa-play"}),video[0].on("timeupdate",function(){if(i<snippets.length){var e=parseFloat(snippets[i].dataset.end),s=parseFloat(snippets[i].dataset.start);complete&&(e=snippets[i].dataset.length,s=0);var t=document.getElementsByClassName("countdown"),a=Math.floor(e-video[0].getCurrentTime())/(e-s)*100+"%";t[0].style.width=t[1].style.width=a,Math.ceil(video[0].getCurrentTime())>=e&&(i==snippets.length-1?(video[0].pause(),debugMessage("This party is over, now get out of here. Seriously.")):(debugMessage("End of snippet, let's go to the next one."),playNext()))}}),mindTheHash(),window.onhashchange=mindTheHash,playPreviousElements=document.getElementsByClassName("playPrevious"),playPauseElements=document.getElementsByClassName("playPause"),playNextElements=document.getElementsByClassName("playNext"),playCompleteElements=document.getElementsByClassName("playComplete"),playMixElements=document.getElementsByClassName("playMix"),searchLyricsElements=document.getElementsByClassName("searchLyrics");for(var temp=0;temp<playPreviousElements.length;temp++)playPreviousElements[temp].onclick=playPrevious;for(var temp=0;temp<playPauseElements.length;temp++)playPauseElements[temp].onclick=playPause;for(var temp=0;temp<playNextElements.length;temp++)playNextElements[temp].onclick=playNext;for(var temp=0;temp<playCompleteElements.length;temp++)playCompleteElements[temp].onclick=playComplete;playMixElements[0].onclick=playMix,searchLyricsElements[0].onclick=searchLyrics,document.addEventListener("keydown",function(e){if("input"!==e.target.nodeName.toLowerCase()&&!e.ctrlKey&&!e.altKey&&!e.shiftKey)switch(e.key){case"f":video[0].toggleFullscreen();break;case"l":searchLyrics();break;case"m":video[0].toggleMute();break;case"x":playMix();break;case"k":case"s":case" ":e.preventDefault(),playPause();break;case"c":playComplete();break;case"a":case"ArrowLeft":playPrevious();break;case"d":case"ArrowRight":playNext()}},!1);